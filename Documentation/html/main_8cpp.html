<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Castle Game: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Castle Game
   &#160;<span id="projectnumber">0.2.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;windows.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;tchar.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;Windowsx.h&gt;</code><br />
<code>#include &quot;<a class="el" href="model_8h_source.html">model.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>&#160;&#160;&#160;(double)3.1415</td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a498d9f026138406895e9a34b504ac6a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a498d9f026138406895e9a34b504ac6a6">WINDOW_WIDTH</a>&#160;&#160;&#160;800</td></tr>
<tr class="separator:a498d9f026138406895e9a34b504ac6a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a30a1e3b0304f1b083637664cbda94e72"><td class="memItemLeft" align="right" valign="top">LRESULT CALLBACK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a30a1e3b0304f1b083637664cbda94e72">WndProc</a> (HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>
<tr class="memdesc:a30a1e3b0304f1b083637664cbda94e72"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is responsible for drawing castle,cannon,lines of mointain, background playing field and shows all the text in the game. As it prescribe management in our game. For control of the game and drawing the background playing field meets the code.  <a href="#a30a1e3b0304f1b083637664cbda94e72">More...</a><br /></td></tr>
<tr class="separator:a30a1e3b0304f1b083637664cbda94e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c2335e6df73b1864dd7563f6810caa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a21c2335e6df73b1864dd7563f6810caa">DoPhysics</a> (ULONGLONG dT)</td></tr>
<tr class="memdesc:a21c2335e6df73b1864dd7563f6810caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function void DoPhysics responsible for all of physics in the game. In this function implements the birds position on the playing field, check with birds touch the pipe, restart the game, adding points with the passage of a bird pipes.  <a href="#a21c2335e6df73b1864dd7563f6810caa">More...</a><br /></td></tr>
<tr class="separator:a21c2335e6df73b1864dd7563f6810caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ecb4242527b80e76b5e28209f67d2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a93ecb4242527b80e76b5e28209f67d2d">StartGame</a> ()</td></tr>
<tr class="memdesc:a93ecb4242527b80e76b5e28209f67d2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">function void StartGame () is designed for the beginning of the start of the game. This function contains all the initial parameters of castles and fields The function code is as follows:  <a href="#a93ecb4242527b80e76b5e28209f67d2d">More...</a><br /></td></tr>
<tr class="separator:a93ecb4242527b80e76b5e28209f67d2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a661c2abc03926acfaeb93b4ae7db4943"><td class="memItemLeft" align="right" valign="top">int WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a661c2abc03926acfaeb93b4ae7db4943">WinMain</a> (HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)</td></tr>
<tr class="separator:a661c2abc03926acfaeb93b4ae7db4943"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44f41244c97693b2fbd5244bcb1e86ec"><td class="memItemLeft" align="right" valign="top">HINSTANCE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a44f41244c97693b2fbd5244bcb1e86ec">hInst</a></td></tr>
<tr class="separator:a44f41244c97693b2fbd5244bcb1e86ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27eb5f0a9384ff54e52ec254c5fe77b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_t_lcastle.html">TLcastle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ae27eb5f0a9384ff54e52ec254c5fe77b">Lcastle</a></td></tr>
<tr class="separator:ae27eb5f0a9384ff54e52ec254c5fe77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f22af085e8fb82afc8f7f4c9af7452"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_t_rcastle.html">TRcastle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ad2f22af085e8fb82afc8f7f4c9af7452">Rcastle</a></td></tr>
<tr class="separator:ad2f22af085e8fb82afc8f7f4c9af7452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3843683a90279624890b32c8f4658192"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_t_shot.html">TShot</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a3843683a90279624890b32c8f4658192">Shot</a></td></tr>
<tr class="separator:a3843683a90279624890b32c8f4658192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f38b0738dbe3f73a0e49a20e8ab9df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_tmap.html">Tmap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a24f38b0738dbe3f73a0e49a20e8ab9df">Map</a></td></tr>
<tr class="separator:a24f38b0738dbe3f73a0e49a20e8ab9df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc5abab889d6fd98fcc0efdc177bd7e"><td class="memItemLeft" align="right" valign="top">HBITMAP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a9fc5abab889d6fd98fcc0efdc177bd7e">hBitmap</a> = NULL</td></tr>
<tr class="separator:a9fc5abab889d6fd98fcc0efdc177bd7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a598a3330b3c21701223ee0ca14316eca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PI&#160;&#160;&#160;(double)3.1415</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a498d9f026138406895e9a34b504ac6a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WINDOW_WIDTH&#160;&#160;&#160;800</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a21c2335e6df73b1864dd7563f6810caa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DoPhysics </td>
          <td>(</td>
          <td class="paramtype">ULONGLONG&#160;</td>
          <td class="paramname"><em>dT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function void DoPhysics responsible for all of physics in the game. In this function implements the birds position on the playing field, check with birds touch the pipe, restart the game, adding points with the passage of a bird pipes. </p>
<p>These formulas are responsible for the correctness of the flight calculation of projectile shells fired one of the castles </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Lcastle.sinus = sin(Lcastle.angle * PI / 180.0); //синус угла альфа</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; Lcastle.cosin = cos(Lcastle.angle*PI / 180.0);//косинус альфа</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; Lcastle.tangens = Lcastle.sinus / Lcastle.cosin;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; Lcastle.toright = 25 * Lcastle.cosin;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; Lcastle.upstairs = 25 * Lcastle.sinus;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; Lcastle.x1 = Lcastle.x + Lcastle.toright;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; Lcastle.y1 = Lcastle.y - Lcastle.upstairs;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; Rcastle.sinus = sin(Rcastle.angle * PI / 180.0); //синус угла альфа</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; Rcastle.cosin = cos(Rcastle.angle*PI / 180.0);//косинус альфа</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; Rcastle.tangens = Rcastle.sinus / Rcastle.cosin;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; Rcastle.toright = 25 * Rcastle.cosin;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; Rcastle.upstairs = 25 * Rcastle.sinus;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; Rcastle.x1 = Rcastle.x + Rcastle.toright;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; Rcastle.y1 = Rcastle.y - Rcastle.upstairs;</div></div><!-- fragment --><p>This part of the code responsible for the flight of the projectile from 0 to 180 degrees. And the process of firing the gun, the action if the projectile hit the target. If the shell hit one of the locks, then it takes away the life. After one of the locks will end the life of the game end scoring another castle </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;double dx = Lcastle.x - 10 - Shot.x;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    double dy = Lcastle.y - Shot.y;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    if (sqrt(dx*dx + dy*dy) &lt;= 15 + Shot.r)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        Shot.draw = 0;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        Shot.x = 100;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        Shot.y = 100;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        Lcastle.health -= 10;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        if (Lcastle.health == 0)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;            Map.gameover = 1;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        }</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        Lcastle.angle = 0;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        Rcastle.angle = 180;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    double dxR = Rcastle.x + 10 - Shot.x;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    double dyR = Rcastle.y - Shot.y;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    if (sqrt(dxR*dxR + dyR*dyR) &lt;= 15 + Shot.r)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        Shot.draw = 0;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        Shot.x = 100;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        Shot.y = 100;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        Rcastle.health -= 10;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        if (Rcastle.health == 0)</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            Map.gameover = 2;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        Lcastle.angle = 0;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        Rcastle.angle = 180;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    Map.xp = Map.xl1;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    for (int i = 0; i&lt;230; i++)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        Map.yp = (4*Map.xp + 1760) / 23;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Map.yp = 600 - Map.yp;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        if (Shot.x &lt;= 250 &amp;&amp; Shot.x &gt;= Map.xp&amp;&amp;Shot.y + Shot.r &gt;= Map.yp)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            Shot.draw = 0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            Shot.x = 100;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            Shot.y = 100;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            Lcastle.angle = 0;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            Rcastle.angle = 180;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        Map.xp++;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Map.xp = Map.xl3;//Map.xl3=250;Map.yl3=480;Map.xl5 = 410;Map.yl5 = 260;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    for (int i = 0; i&lt;160; i++)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        Map.yp = (11 * Map.xp - 1790)/8;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        Map.yp = 600 - Map.yp;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        if (Shot.x &lt;= 410 &amp;&amp; Shot.x &gt;= Map.xp&amp;&amp;Shot.y + Shot.r &gt;= Map.yp)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            Shot.draw = 0;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            Shot.x = 100;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            Shot.y = 100;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            Lcastle.angle = 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            Rcastle.angle = 180;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Map.xp++;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Map.xp = Map.xl5;//Map.xl5=410;Map.yl5=260;Map.xl6=520;Map.yl6=460;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    for (int i = 0; i&lt;110; i++)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        Map.yp = (-20 * Map.xp + 12140) / 11;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        Map.yp = 600 - Map.yp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        if (Shot.x &gt;= 410 &amp;&amp; Shot.x &lt;= Map.xp&amp;&amp;Shot.y + Shot.r &gt;= Map.yp)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            Shot.draw = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            Shot.x = 100;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            Shot.y = 100;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            Lcastle.angle = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            Rcastle.angle = 180;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Map.xp++;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    Map.xp = Map.xl6;//Map.xl6=520;Map.yl6=460;Map.xl7=590;Map.yl7=500;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    for (int i = 0; i&lt;70; i++)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        Map.yp = (-4 * Map.xp + 3060) / 7;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        Map.yp = 600 - Map.yp;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        if (Shot.x &gt;= 520 &amp;&amp; Shot.x &lt;= Map.xp&amp;&amp;Shot.y + Shot.r &gt;= Map.yp)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            Shot.draw = 0;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            Shot.x = 100;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            Shot.y = 100;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            Lcastle.angle = 0;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            Rcastle.angle = 180;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Map.xp++;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    Map.xp = Map.xl7;//Map.xl7=590;Map.yl7=500;Map.xl8=750;Map.yl8=500;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    for (int i = 0; i&lt;160; i++)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        Map.yp = 500;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        if (Shot.x &gt;= 520 &amp;&amp; Shot.x &lt;= Map.xp&amp;&amp;Shot.y + Shot.r &gt;= Map.yp)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            Shot.draw = 0;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            Shot.x = 100;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            Shot.y = 100;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            Lcastle.angle = 0;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            Rcastle.angle = 180;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        Map.xp++;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    if ((Shot.x &lt; 0) || (Shot.x &gt; 800) || (Shot.y &lt; 0) || (Shot.y &gt; 600))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Shot.draw = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        Shot.x = 100;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        Shot.y = 100;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        Lcastle.angle = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Rcastle.angle = 180;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    else</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a93ecb4242527b80e76b5e28209f67d2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StartGame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function void StartGame () is designed for the beginning of the start of the game. This function contains all the initial parameters of castles and fields The function code is as follows: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void StartGame()</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    srand(GetTickCount());</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    RECT r = { 100, 100, 700, 400 };</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    Map.gameover = 0;//0-игра идет, 1-лицо сломалось у левого, 2-лицо сломалось у правого</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    Lcastle.angle = 10;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    Lcastle.x = 55;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    Lcastle.y = 500;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    Lcastle.x1 = 80;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    Lcastle.y1 = 475;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    Rcastle.angle = 170;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    Rcastle.x = 715;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    Rcastle.y = 485;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    Rcastle.x1 = 690;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    Rcastle.y1 = 475;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    Lcastle.health = 30;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    Rcastle.health = 30;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    Shot.switched=0;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    Shot.r = 10;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    Shot.x = 20;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    Shot.y = 20;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Shot.t = 0;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Shot.vnx = 140;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Shot.vny = 140;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    Shot.a = 0.1;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    Shot.y1 = Lcastle.y1;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    Shot.x1 = Lcastle.x1;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    Shot.changed = 0;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    Shot.G = 35;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    Shot.draw = 0;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    Map.x = 60;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    Map.y = 600;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    Map.xp = 60;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    Map.yp = 600;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    Map.xl1 = 20;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    Map.yl1 = 520;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    //Map.xl2 = 180;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    //Map.yl2 = 480;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    Map.xl3 = 250;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    Map.yl3 = 480;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    //Map.xl4 = 370;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    //Map.yl4 = 300;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    Map.xl5 = 410;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    Map.yl5 = 260;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    Map.xl6 = 520;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    Map.yl6 = 460;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    Map.xl7 = 590;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    Map.yl7 = 500;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    Map.xl8 = 750;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    Map.yl8 = 500;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    Map.info=0;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a661c2abc03926acfaeb93b4ae7db4943"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int WINAPI WinMain </td>
          <td>(</td>
          <td class="paramtype">HINSTANCE&#160;</td>
          <td class="paramname"><em>hInstance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HINSTANCE&#160;</td>
          <td class="paramname"><em>hPrevInstance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPSTR&#160;</td>
          <td class="paramname"><em>lpCmdLine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nCmdShow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a30a1e3b0304f1b083637664cbda94e72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LRESULT CALLBACK WndProc </td>
          <td>(</td>
          <td class="paramtype">HWND&#160;</td>
          <td class="paramname"><em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WPARAM&#160;</td>
          <td class="paramname"><em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPARAM&#160;</td>
          <td class="paramname"><em>lParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is responsible for drawing castle,cannon,lines of mointain, background playing field and shows all the text in the game. As it prescribe management in our game. For control of the game and drawing the background playing field meets the code. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;switch (message)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;   {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;   case WM_CREATE: //load picture on background </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       hBitmap = (HBITMAP)LoadImage(hInst, L&quot;1.bmp&quot;, IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;       break;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;   case WM_KEYDOWN:</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;       switch (wParam)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;       {</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;       case &#39;R&#39;: //Restart game</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;       ch.y=100;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;       dX=-150;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      for (int i = 0; i&lt;TUBE_COUNT; i++)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;       {tubes[i] = CreateTube(i*(WINDOW_WIDTH / TUBE_COUNT) + WINDOW_WIDTH);}</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;       Score=0;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;       GameOver=0;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;       break;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;       case &#39; &#39;: //Jump birds</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;           ch.vy = -300;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;           break;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;       case &#39;P&#39;:  //Pause game</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;           pause = !(pause);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;           break;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;       case VK_F5: case &#39;S&#39;: //Save coordinate bird and tube</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;           tmpX = ch.X;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;           tmpY = ch.y;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;           tmpV = ch.vy;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;           tmpScore = Score;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;           //</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;           for (int i(0); i &lt; TUBE_COUNT;i++)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;           { </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;               tmpTX[i] = tubes[i].X;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;               tmpTY[i] = tubes[i].Y;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;           }           </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;           break;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;       case VK_F8: case &#39;L&#39;: //Load coordinate bird and tube</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;           ch.X = tmpX;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;           ch.y = tmpY;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;           ch.vy = tmpV;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;           Score = tmpScore;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;           //</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;           for (int i(0); i &lt; TUBE_COUNT; i++)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;           {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;               tubes[i].X = tmpTX[i];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;               tubes[i].Y = tmpTY[i];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;           }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;           break;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       }</div></div><!-- fragment --><p> This part of the code responsible for drawing tubes and birds. Drawing in WinApi performed using brushes and pens. With feathers, we draw the contours of our castle,cannon and lines of mointain. With a brush paints we figure our color. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;case WM_PAINT:</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        PAINTSTRUCT     ps;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        HDC             hdc;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        BITMAP          bitmap;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        HDC             hdcMem;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        HGDIOBJ         oldBitmap;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        hdc = BeginPaint(hWnd, &amp;ps);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        RECT rect;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        GetClientRect(hWnd, &amp;rect);</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        width = rect.right;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        height = rect.bottom;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        backbuffDC = CreateCompatibleDC(hdc);</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        backbuffer = CreateCompatibleBitmap(hdc, width, height);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        savedDC = SaveDC(backbuffDC);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        SelectObject(backbuffDC, backbuffer);</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        // Draw HERE</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        //clear window</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        hBrush = CreateSolidBrush(RGB(255, 255, 255));</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        FillRect(backbuffDC, &amp;rect, hBrush);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        DeleteObject(hBrush);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            hdcMem = CreateCompatibleDC(hdc);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        oldBitmap = SelectObject(hdcMem, hBitmap);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; GetObject(hBitmap, sizeof(bitmap), &amp;bitmap);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        BitBlt(backbuffDC, 0, 0, bitmap.bmWidth, bitmap.bmHeight, hdcMem, 0, 0, SRCCOPY);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        //draw castles</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        hPen = CreatePen(PS_SOLID, 3, RGB(0, 255, 0));//!</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   hOldPen = (HPEN)SelectObject(backbuffDC, hPen);//!</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        //Lcastle.d=sqrt((Lcastle.width*Lcastle.width)+(Lcastle.height*Lcastle.height));</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        Rectangle(backbuffDC, Lcastle.x - 25, Lcastle.y - 15, Lcastle.x + 5, Lcastle.y + 15);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        MoveToEx(backbuffDC, Lcastle.x, Lcastle.y, NULL);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        LineTo(backbuffDC, Lcastle.x1, Lcastle.y1);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        Rectangle(backbuffDC, Rcastle.x - 5, Rcastle.y - 15, Rcastle.x + 25, Rcastle.y + 15);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        MoveToEx(backbuffDC, Rcastle.x, Rcastle.y, NULL);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        LineTo(backbuffDC, Rcastle.x1, Rcastle.y1);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        MoveToEx(backbuffDC, Map.xl1, Map.yl1, NULL);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        LineTo(backbuffDC, Map.xl3, Map.yl3);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        MoveToEx(backbuffDC, Map.xl3, Map.yl3, NULL);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        LineTo(backbuffDC, Map.xl5, Map.yl5);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        MoveToEx(backbuffDC, Map.xl5, Map.yl5, NULL);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        LineTo(backbuffDC, Map.xl6, Map.yl6);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        MoveToEx(backbuffDC, Map.xl6, Map.yl6, NULL);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        LineTo(backbuffDC, Map.xl7, Map.yl7);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        MoveToEx(backbuffDC, Map.xl7, Map.yl7, NULL);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        LineTo(backbuffDC, Map.xl8, Map.yl8);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        //draw shot</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        if (Shot.draw != 0)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            Ellipse(backbuffDC, Shot.x - Shot.r, Shot.y - Shot.r, Shot.x + Shot.r, Shot.y + Shot.r);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        SelectObject(backbuffDC, hOldPen);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   DeleteObject(hPen);</div></div><!-- fragment --><p> This part of the code responsible for entering text on a screen. To enter text on the screen creates an array of characters. Using this array, we can create the text. If the number of characters exceeds the specified number of the program will display an error. The text displayed on the screen at a certain place and under certain conditions. The implementation is shown below </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;WCHAR s[100];</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        wsprintf(s, _T(&quot;%d&quot;), (int)Lcastle.health);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        TextOut(backbuffDC, Lcastle.x - 20, Lcastle.y - 5, s, wcslen(s));</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        wsprintf(s, _T(&quot;%d&quot;), (int)Rcastle.health);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        TextOut(backbuffDC, Rcastle.x + 5, Rcastle.y - 5, s, wcslen(s));</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        wsprintf(s, _T(&quot;Press I to check the instructions&quot;));</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        TextOut(backbuffDC, 25, 20, s, wcslen(s));</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        </div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        if(Map.info==0)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        }</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        else</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            wsprintf(s, _T(&quot;To increase gun&#39;s height press and hold W&quot;));</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            TextOut(backbuffDC, 25, 45, s, wcslen(s));</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            wsprintf(s, _T(&quot;To decrease gun&#39;s height press and hold S&quot;));</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            TextOut(backbuffDC, 25, 60, s, wcslen(s));</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            wsprintf(s, _T(&quot;To shoot press space&quot;));</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            TextOut(backbuffDC, 25, 75, s, wcslen(s));</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            wsprintf(s, _T(&quot;To restart press R&quot;));</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            TextOut(backbuffDC, 25, 90, s, wcslen(s));</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        if (Shot.switched == 0)</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            wsprintf(s, _T(&quot;Right castle&#39;s turn!&quot;));</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            TextOut(backbuffDC, 600, 10, s, wcslen(s));</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        if (Shot.switched == 1)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            wsprintf(s, _T(&quot;Left castle&#39;s turn!&quot;));</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            TextOut(backbuffDC, 600, 10, s, wcslen(s));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        if (Map.gameover == 1)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            wsprintf(s, _T(&quot;Game over!&quot;));</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            TextOut(backbuffDC, 600, 35, s, wcslen(s));</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            wsprintf(s, _T(&quot;Right castle won!&quot;));</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            TextOut(backbuffDC, 600, 50, s, wcslen(s));</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            wsprintf(s, _T(&quot;GAME OVER!&quot;));</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            TextOut(backbuffDC, 350, 25, s, wcslen(s));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            wsprintf(s, _T(&quot;PRESS &#39;R&#39; TO RESTART!&quot;));</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            TextOut(backbuffDC, 320, 50, s, wcslen(s));</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        if (Map.gameover == 2)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            wsprintf(s, _T(&quot;Game over!&quot;));</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            TextOut(backbuffDC, 600, 35, s, wcslen(s));</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            wsprintf(s, _T(&quot;Left castle won!&quot;));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            TextOut(backbuffDC, 600, 50, s, wcslen(s));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            wsprintf(s, _T(&quot;GAME OVER!&quot;));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            TextOut(backbuffDC, 350, 25, s, wcslen(s));</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            wsprintf(s, _T(&quot;PRESS &#39;R&#39; TO RESTART!&quot;));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            TextOut(backbuffDC, 320, 50, s, wcslen(s));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div></div><!-- fragment --> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a9fc5abab889d6fd98fcc0efdc177bd7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HBITMAP hBitmap = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a44f41244c97693b2fbd5244bcb1e86ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HINSTANCE hInst</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae27eb5f0a9384ff54e52ec254c5fe77b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_t_lcastle.html">TLcastle</a> Lcastle</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a24f38b0738dbe3f73a0e49a20e8ab9df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_tmap.html">Tmap</a> Map</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad2f22af085e8fb82afc8f7f4c9af7452"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_t_rcastle.html">TRcastle</a> Rcastle</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3843683a90279624890b32c8f4658192"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_t_shot.html">TShot</a> Shot</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
